<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ú–µ—Ç—Ä–æ–†—ã–Ω–æ–∫</title>
  <style>
    body {
      margin: 0;
      background-color: #0f0f0f;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
    }

    /* üî∑ –®–∞–ø–∫–∞ */
    header {
      background: linear-gradient(to right, var(--dark-color), var(--light-color));
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 40px;
      transition: background 0.5s;
    }

    .logo h1 {
      margin: 0;
      font-size: 1.5em;
    }

    .slogan {
      font-size: 0.9em;
      color: #e0e0ff;
    }

    nav button {
      background: rgba(255, 255, 255, 0.15);
      border: none;
      color: #fff;
      padding: 8px 16px;
      margin-left: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.3s;
    }

    nav button:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* –†–∞–∑–¥–µ–ª—ã */
    section {
      max-width: 800px;
      margin: 40px auto;
      background: #1c1c1c;
      padding: 20px;
      border-radius: 12px;
    }

    h2 {
      color: #90a0f9;
    }

    /* –§–æ—Ä–º–∞ */
    input, select {
      width: 100%;
      padding: 10px;
      margin: 6px 0;
      background: #222;
      color: #fff;
      border: 1px solid #333;
      border-radius: 6px;
    }

    button[type="submit"] {
      background: #0066ff;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      color: #fff;
      transition: 0.3s;
    }

    button[type="submit"]:hover {
      background: #0055cc;
    }

    /* üî∏ –¢–æ–≤–∞—Ä—ã */
    .item {
      border: 2px solid transparent;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 10px;
      background: #141414;
    }

    .broken { border-color: gray; }
    .repaired { border-color: green; }
    .normal { border-color: blue; }
    .improved { border-color: purple; }
    .high { border-color: pink; }
    .gold { border-color: gold; }

    footer {
      text-align: center;
      padding: 20px;
      color: #777;
    }

    .img-preview {
      max-width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <header id="mainHeader">
    <div class="logo">
      <h1>–ú–µ—Ç—Ä–æ–†—ã–Ω–æ–∫</h1>
      <div class="slogan">–ë—ã—Å—Ç—Ä—ã–π –æ–±–º–µ–Ω –ø–æ –≤—Å–µ–π –∏–≥—Ä–µ</div>
    </div>
    <nav>
      <button onclick="showSection('market')">–¢–æ–≤–∞—Ä—ã</button>
      <button onclick="showSection('publish')">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
      <button onclick="showSection('about')">–û –Ω–∞—Å</button>
    </nav>
  </header>

  <section id="market">
    <h2>–¢–æ–≤–∞—Ä—ã</h2>
    <div id="itemsList">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</div>
  </section>

  <section id="publish" style="display:none;">
    <h2>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h2>
    <form id="publishForm">
      <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞:</label>
      <input type="text" id="itemName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" required>

      <label>–†–µ–¥–∫–æ—Å—Ç—å:</label>
      <select id="itemRarity">
        <option>–ü–æ–ª–æ–º–∞–Ω–Ω–∞—è</option>
        <option>–û—Ç—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è</option>
        <option>–¶–µ–ª–∞—è</option>
        <option>–£–ª—É—á—à–µ–Ω–Ω–∞—è</option>
        <option>–í—ã—Å—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ</option>
        <option>–ó–æ–ª–æ—Ç–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ</option>
      </select>

      <label>–£—Ä–æ–≤–µ–Ω—å –±—Ä–æ–Ω–∏:</label>
      <select id="itemLevel">
        <option>1 —É—Ä–æ–≤–µ–Ω—å</option>
        <option>2 —É—Ä–æ–≤–µ–Ω—å</option>
        <option>3 —É—Ä–æ–≤–µ–Ω—å</option>
        <option>4 —É—Ä–æ–≤–µ–Ω—å</option>
        <option>5 —É—Ä–æ–≤–µ–Ω—å</option>
        <option>6 —É—Ä–æ–≤–µ–Ω—å</option>
      </select>

      <label>–¶–µ–Ω–∞:</label>
      <input type="text" id="itemPrice" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ü–µ–Ω—É">

      <label>–°–ø–æ—Å–æ–± —Å–≤—è–∑–∏:</label>
      <input type="text" id="itemContact" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: @nickname –∏–ª–∏ –Ω–æ–º–µ—Ä">

      <label>–§–æ—Ç–æ –ø—Ä–µ–¥–º–µ—Ç–∞ (—Å—Å—ã–ª–∫–∞):</label>
      <input type="text" id="itemImage" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">

      <button type="submit">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
    </form>
  </section>
<section id="about" style="display:none;">
    <h2>–û –Ω–∞—Å</h2>
    <p>–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –æ–±–º–µ–Ω–∞ –º–µ–∂–¥—É –∏–≥—Ä–æ–∫–∞–º–∏ —Ä–µ–∂–∏–º–∞ Metro Royal.</p>
  </section>

  <footer>¬© –ú–µ—Ç—Ä–æ–†—ã–Ω–æ–∫ ‚Äî 2025</footer>

  <script>
    const SERVER_URL = "https://metro-rynok.onrender.com"; // ‚Üê –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π Render URL
    const header = document.getElementById("mainHeader");

    function showSection(id) {
      document.querySelectorAll("section").forEach(sec => sec.style.display = "none");
      document.getElementById(id).style.display = "block";

      if (id === "market") {
        header.style.setProperty("--dark-color", "#001144");
        header.style.setProperty("--light-color", "#0088ff");
        loadItems();
      } else if (id === "about") {
        header.style.setProperty("--dark-color", "#330055");
        header.style.setProperty("--light-color", "#aa44ff");
      } else if (id === "publish") {
        header.style.setProperty("--dark-color", "#004422");
        header.style.setProperty("--light-color", "#00cc66");
      }
    }

    header.style.setProperty("--dark-color", "#001144");
    header.style.setProperty("--light-color", "#0088ff");

    // üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
    async function loadItems() {
      const list = document.getElementById("itemsList");
      list.innerHTML = "–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...";
      try {
        const res = await fetch(${SERVER_URL}/items);
        const data = await res.json();
        list.innerHTML = "";
        if (data.length === 0) {
          list.innerHTML = "<p>–ü–æ–∫–∞ –Ω–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.</p>";
          return;
        }
        data.forEach(item => {
          const div = document.createElement("div");
          div.className = "item " + getRarityClass(item.rarity);
          div.innerHTML = 
            <b>${item.name}</b><br>
            –†–µ–¥–∫–æ—Å—Ç—å: ${item.rarity}<br>
            –£—Ä–æ–≤–µ–Ω—å: ${item.level}<br>
            –¶–µ–Ω–∞: ${item.price}<br>
            –ö–æ–Ω—Ç–∞–∫—Ç: ${item.contact}<br>
            ${item.image ? <img src="${item.image}" class="img-preview"> : ""}
          ;
          list.appendChild(div);
        });
      } catch (err) {
        list.innerHTML = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤.";
      }
    }

    // üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
    document.getElementById("publishForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const newItem = {
        name: document.getElementById("itemName").value,
        rarity: document.getElementById("itemRarity").value,
        level: document.getElementById("itemLevel").value,
        price: document.getElementById("itemPrice").value,
        contact: document.getElementById("itemContact").value,
        image: document.getElementById("itemImage").value,
        owner_id: "guest"
      };

      try {
        await fetch(${SERVER_URL}/items, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(newItem)
        });
        alert("‚úÖ –¢–æ–≤–∞—Ä –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!");
        showSection("market");
      } catch (err) {
        alert("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.");
      }
    });

    function getRarityClass(rarity) {
      switch (rarity) {
        case "–ü–æ–ª–æ–º–∞–Ω–Ω–∞—è": return "broken";
        case "–û—Ç—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è": return "repaired";
        case "–¶–µ–ª–∞—è": return "normal";
        case "–£–ª—É—á—à–µ–Ω–Ω–∞—è": return "improved";
        case "–í—ã—Å—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ": return "high";
        case "–ó–æ–ª–æ—Ç–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ": return "gold";
        default: return "";
      }
    }

    loadItems();
  </script>
</body>
</html>